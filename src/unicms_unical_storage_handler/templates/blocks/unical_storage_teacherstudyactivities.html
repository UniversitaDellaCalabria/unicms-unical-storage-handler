{% extends "bases/unical_storage_list.html" %}

{% load i18n %}
{% load static %}

{% load unicms_storage_handler %}
{% load unicms_templates %}

{% block pagination_content %}
<div id="{{ id }}">

    <loading-icon
        v-if="is_loading"
        :loader_source="loader_source">
    </loading-icon>

    <div v-else>
        {% block filters_teacherstudyactivities %}
        <div class="row">
            <div class="col-12">
                <div class="card-wrapper card-space">
                    <div class="card card-bg no-after">
                        <br>
                        <div class="card-body">
                            <!-- Year & YearFrom & YearTo -->
                            <div class="form-group">
                                <div class="row">
                                    <div class="col-sm">
                                        <div class="bootstrap-select-wrapper ml-5 mr-5">
                                            <label for="year_input">{% trans "Anno" %}</label>
                                            <div class="w-30 mt-5">
                                                <span class="input-number">
                                                    <input type="number" id="year_input" name="year_input">
                                                    <button class="input-number-add">
                                                        <span class="sr-only">{% trans "Aumenta valore" %}</span>
                                                    </button>
                                                    <button class="input-number-sub">
                                                        <span class="sr-only">{% trans "Diminuisci valore" %}</span>
                                                    </button>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm">
                                        <div class="bootstrap-select-wrapper ml-5 mr-5">
                                            <label for="year_from_input">{% trans "Da Anno" %}</label>
                                            <div class="w-30 mt-5">
                                                <span class="input-number">
                                                    <input type="number" id="year_from_input" name="year_from_input">
                                                    <button class="input-number-add">
                                                        <span class="sr-only">{% trans "Aumenta valore" %}</span>
                                                    </button>
                                                    <button class="input-number-sub">
                                                        <span class="sr-only">{% trans "Diminuisci valore" %}</span>
                                                    </button>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm">
                                        <div class="bootstrap-select-wrapper ml-5 mr-5">
                                            <label for="role_input">{% trans "Fino ad Anno" %}</label>
                                            <div class="w-30 mt-5">
                                                <span class="input-number">
                                                    <input type="number" id="year_to_input" name="year_to_input">
                                                    <button class="input-number-add">
                                                        <span class="sr-only">{% trans "Aumenta valore" %}</span>
                                                    </button>
                                                    <button class="input-number-sub">
                                                        <span class="sr-only">{% trans "Diminuisci valore" %}</span>
                                                    </button>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm">
                                        <div class="w-20 mt-5 ml-5 mr-5">
                                            <button class="btn btn-primary" type="button" id="search-button"
                                                v-on:click="search()">{% trans "Cerca" %}</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endblock filters_teacherstudyactivities %}


        <list-panel v-bind:data="items" v-if="items.results"></list-panel>

        <div class="row">
            <div class="table-responsive">
                <table class="table table-sm">
                    <thead>
                        <tr>
                            <th scope="col">[[ labels.StudyActivityName ]]</th>
                            <th scope="col">[[ labels.StudyActivityAA ]]</th>
                            <th scope="col">[[ labels.StudyActivityCdSName ]]</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr v-for="item in items.results">
                            <td>
                                {% settings_value "CMS_PATH_PREFIX" as cms_path_prefix %}
                                {% settings_value "CMS_STORAGE_BASE_PATH" as base_prefix %}
                                {% settings_value "CMS_STORAGE_CDS_VIEW_PREFIX_PATH" as cds_prefix %}
                                {% settings_value "CMS_STORAGE_ACTIVITY_VIEW_PREFIX_PATH" as activity_prefix %}
                                <a :href="'/{{ cms_path_prefix }}{{ base_prefix }}/{{ cds_prefix }}/' + [[ item.StudyActivityRegDidId ]] + '/{{ activity_prefix }}/' + [[ item.StudyActivityID ]] +'/'">
                                    [[ item.StudyActivityName ]]
                                    <span v-if="item.StudyActivityCompulsory == 1">*</span>
                                </a>
                            </td>
                            <td>[[ item.StudyActivityAA ]]</td>
                            <td>
                                <a :href="'/{{ cms_path_prefix }}{{ base_prefix }}/{{ cds_prefix }}/' + [[ item.StudyActivityRegDidId ]] + '/'">
                                    [[ item.StudyActivityCdSName ]]
                                </a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>


        </div>

        <list-panel v-bind:data="items" v-if="items.results"></list-panel>

    </div>
</div>
{% endblock pagination_content %}

{% block pagination_extra_scripts %}
<script>
function get_form_paramenters() {
    let dict = {};

    // year
    let year = document.getElementById('year_input').value
    if (year) dict['year'] = year

    // year_to
    let year_to = document.getElementById('year_to_input').value
    if (year_to) dict['yearTo'] = year_to

    // year_from
    let year_from = document.getElementById('year_from_input').value
    if (year_from) dict['yearFrom'] = year_from

    return dict
}
</script>
{% endblock pagination_extra_scripts %}
