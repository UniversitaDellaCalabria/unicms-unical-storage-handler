{% extends "bases/unical_storage_list.html" %}

{% load i18n %}
{% load static %}

{% load unicms_storage_handler %}
{% load unicms_templates %}

{% block content %}



<div id="{{ id }}">
    <div v-if="(initial_items && initial_items.length) || parameters">

{#        {% block filters_teachingmaterials %}#}
{#        <div class="row">#}
{#            <div class="col-12">#}
{#                <div class="card-wrapper card-space">#}
{#                    <div class="card card-bg no-after">#}
{#                        <div class="card-body">#}
{#                            {% include "includes/unical_storage_search_input.html" with id=id %}#}
{#                        </div>#}
{#                    </div>#}
{#                </div>#}
{#            </div>#}
{#        </div>#}
{#        {% endblock filters_teachingmaterials %}#}


        <list-panel v-bind:data="items" v-if="items.results" id="{{ id }}"></list-panel>

        <loading-icon
            v-if="is_loading"
            :loader_source="loader_source">
        </loading-icon>

        <div v-else>
            <div class="table-responsive">
                <table class="table table-sm table-hover table-striped">
                    <thead>
                        <tr>
                            <th scope="col">[[ labels.Title ]]</th>
                            <th scope="col">[[ labels.Text ]]</th>
                            <th scope="col">[[ labels.TextUrl ]]</th>
                            <th scope="col">[[ labels.Order ]]</th>
                            <th scope="col">[[ labels.Active ]]</th>
                            <th scope="col">[[ labels.PublicationDate ]]</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr v-for="item in items.results">
                            <td>[[ item.Title ]]</td>
                            <td>[[ item.Text ]]</td>
                            <td>
                                <a :href="[[ item.TextUrl ]]" target="_blank" rel="noopener noreferrer">
                                        [[ item.TextUrl ]]
                                    </a>
                            </td>
                            <td>[[ item.Order ]]</td>
                            <td>[[ item.Active ]]</td>
                            <td>[[ item.PublicationDate ]]</td>
                        </tr>
                    </tbody>
                </table>
            </div>


        </div>

        <list-panel v-bind:data="items" v-if="items.results" id="{{ id }}"></list-panel>

    </div>

    <div v-else>
        {% trans "No items here" %}
    </div>

</div>
{% endblock content %}

{% block extra_scripts %}
<script>
function {{ id }}_get_form_paramenters() {
    let dict = {};

    {% comment %}

    // year
    let year = document.getElementById('{{ id }}_year_input')
    if (year && year.value) dict['year'] = year.value

    // year_to
    let year_to = document.getElementById('{{ id }}_year_to_input')
    if (year_to && year_to.value) dict['yearTo'] = year_to.value

    // year_from
    let year_from = document.getElementById('{{ id }}_year_from_input')
    if (year_from && year_from.value) dict['yearFrom'] = year_from.value
    {% endcomment %}

    setItemInSession("{{ id }}", dict)

    return dict
}
</script>
{% endblock extra_scripts %}

{% block extra_data %}

selected_search: this.getItemFromSession("{{ id }}", 'search'),

{% comment %}
selected_year: this.getItemFromSession("{{ id }}", 'year') || {{ id }}_get_param('year'),
selected_year_from: this.getItemFromSession("{{ id }}", 'yearFrom'),
selected_year_to: this.getItemFromSession("{{ id }}", 'yearTo'),
{% endcomment %}

{% endblock extra_data %}

{% block extra_mounted %}

this.parameters = {{ id }}_encodeQueryData(this.getItemsFromSession("{{ id }}"))


{% endblock extra_mounted %}
